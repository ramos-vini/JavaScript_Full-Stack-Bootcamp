<!--
  Utilizando orientação a objetos crie uma classe chamada Produto e uma classe chamada Carrinho.

  O programa basicamente deverá adicionar x produtos no carrinho (Use laços de repetição para isso).
  As informações que devem ser solicitadas para cada produto são o código de barras para que seja
  possível identificar qual é o produto e a quantidade que será adicionada ao carrinho.
  Com essas informações o programa deverá exibir o extrado com o descritivo dos produtos e o valor total da compra.
-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrinho de Compras</title>
</head>

<body>
    <h1>Mercadinho</h1>

    <table border="1">
        <thead>
            <tr>
                <td colspan="3">Itens Disponíveis</td>
            </tr>
            <tr>
                <td><b>Produto</b></td>
                <td><b>Código de Barras</b></td>
                <td><b>Preço</b></td>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>Ovo</td>
                <td>1234567890</td>
                <td>R$ 5,00</td>
            </tr>
            <tr>
                <td>Leite</td>
                <td>1234509876</td>
                <td>R$ 6,00</td>
            </tr>
            <tr>
                <td>Mandioca</td>
                <td>0987654321</td>
                <td>R$ 7,00</td>
            </tr>
            <tr>
                <td>Espinafre</td>
                <td>0987612345</td>
                <td>R$ 8,00</td>
            </tr>
        </tbody>
    </table>

    <p>
        Código de Barras: <input type="number" name="" id="inCodigo">
    </p>

    <p>
        Quantidade: <input type="number" name="" id="inQuantidade">
    </p>

    <input type="button" value="Adicionar ao Carrinho" id="btAdicionar">

    <h3 id="outCarrinho"></h3>

    <p id="outLista"></p>

    <script>
        class Produto {
            constructor(nome, codigo, preco) {
                this.nome = nome;
                this.codigo = codigo;
                this.preco = preco;
            }
        }

        let produtos = [];

        let produto1 = new Produto("Ovo", "1234567890", 5.0);
        produtos.push(produto1);

        let produto2 = new Produto("Leite", "1234509876", 6.0);
        produtos.push(produto2);

        let produto3 = new Produto("Mandioca", "0987654321", 7.0);
        produtos.push(produto3);

        let produto4 = new Produto("Espinafre", "0987612345", 8.0);
        produtos.push(produto4);

        class Carrinho {

            produtos = [];

            valorTotal = 0;
        }

        let carrinho = new Carrinho();

        function AdicionarProduto() {
            let inCodigo = document.getElementById("inCodigo");
            let inQuantidade = document.getElementById("inQuantidade");
            let outCarrinho = document.getElementById("outCarrinho");
            let outLista = document.getElementById("outLista");

            let codigo = inCodigo.value;
            let quantidade = parseInt(inQuantidade.value);

            if (codigo == "") {
                alert("Por favor, digite um Código de Barras válido.");
                inCodigo.focus();
                return;
            }

            if (isNaN(quantidade) || quantidade < 1) {
                alert("Por favor, digite um Quantidade válida.");
                inQuantidade.focus();
                return;
            }

            let itemDisponivel = false;

            for (let i = 0; i < produtos.length; i++) {
                if (codigo == produtos[i].codigo) {
                    itemDisponivel = true;
                    for (let j = 0; j < quantidade; j++) {
                        carrinho.produtos.push(produtos[i]);
                    }
                    carrinho.valorTotal += produtos[i].preco * quantidade;
                }
            }

            if (itemDisponivel == false) {
                alert("Por favor, digite um Código de Barras válido.");
                inCodigo.focus();
                return;
            }

            let produtosAdicionados = [];

            for (let i = 0; i < carrinho.produtos.length; i++) {
                if (produtosAdicionados)
                    produtosAdicionados.push({ "nome": carrinho.produtos[i].nome, "quantidade": quantidade });
            }

            let lista = "";

            for (produto of carrinho.produtos) {
                lista += `${produto.nome} - R$ ${produto.preco.toFixed(2).replace(".", ",")}<br>`;
            }

            outCarrinho.innerHTML = "Seu Carrinho:";

            outLista.innerHTML = `${lista}<br>------------------------<br><b>TOTAL: R$ ${carrinho.valorTotal.toFixed(2).replace(".", ",")}`;

            inCodigo.value = "";
            inQuantidade.value = "";
            inCodigo.focus();
        }
        let btAdicionar = document.getElementById("btAdicionar");
        btAdicionar.addEventListener("click", AdicionarProduto);


    </script>
</body>

</html>